# KMCC 퀴즈 시스템 v3.0

AI 기반 맞춤형 직무능력 테스트 시스템

## 🎯 주요 기능

### 1. **역할별 맞춤 문제**
- 상담사(신입): 초급 문제
- 상담사: 중급 문제  
- 관리자: 고급 문제

### 2. **혼합 문제 출제**
- 선택 서비스: 70%
- T공통 정책: 30%

### 3. **관리자 커스텀 프롬프트**
- 월별/서비스별 출제 방향 설정
- 난이도 조정
- 특정 주제 집중 출제

### 4. **개선된 결과 조회**
- 한글 깨짐 해결
- 시간초과 정보 표시
- 문제/답변 전체 데이터 포함

## 📦 설치 방법

### 1. 의존성 설치
```bash
pip install -r requirements.txt
```

### 2. API 키 설정
```bash
# .env 파일 생성
cp .env.example .env

# .env 파일 편집
nano .env
# GEMINI_API_KEY=your_actual_key 입력
```

### 3. 정책 파일 준비
```
policies/
  ├── 택시/
  │   ├── 정책1.md
  │   └── 정책2.md
  ├── 대리/
  │   └── 정책.md
  ├── 퀵/
  ├── 바이크/
  ├── 주차/
  └── T공통/
      └── 공통정책.md
```

### 4. 서버 실행
```bash
python app_v3.py
```

## 🌐 페이지 구성

### 메인 페이지 (/)
- 신청자 정보 입력
- 역할 선택
- 재응시 체크
- 시험 응시

### 결과 조회 (/results)
- 전체 결과 조회
- 필터링/검색
- 엑셀 다운로드
- 상세보기

### 관리자 페이지 (/admin)
- 커스텀 프롬프트 설정
- 월별 출제 방향 관리
- 난이도 조정

## 📊 데이터베이스

SQLite 사용 (`quiz_results.db`)

### 테이블

#### results
- 시험 결과 저장
- 문제/답변 JSON 저장
- 시간초과 여부

#### admin_prompts
- 관리자 커스텀 프롬프트
- 월별/서비스별 설정

## 🔧 설정

### 타이머
- 제한 시간: 5분 (300초)
- 1분 전 알림
- 시간 초과 시 자동 제출

### 문제 구성
- 총 10문제
- 객관식 8문제
- 주관식 2문제

### 정책 비율
- 선택 서비스: 70% (7문제)
- T공통: 30% (3문제)

## 📝 API 엔드포인트

### GET /
메인 페이지

### GET /results
결과 조회 페이지

### GET /admin
관리자 페이지

### GET /api/services
서비스 목록 조회

### POST /api/check-attempt
재응시 가능 여부 확인

### POST /api/generate-quiz
퀴즈 생성 (AI)

### POST /api/submit
시험 결과 제출

### GET /api/results
결과 조회 (필터링)

### GET /api/export-excel
엑셀 다운로드

### GET/POST /api/admin/prompts
관리자 프롬프트 관리

## 💡 사용 예시

### 1. 일반 응시자
```
1. http://localhost:5001 접속
2. 정보 입력 (ID, 이름, 센터, 역할, 서비스)
3. 시험 시작
4. 5분 내 문제 풀이
5. 제출
```

### 2. 관리자
```
1. http://localhost:5001/admin 접속
2. 이번 달 출제 방향 설정
3. 예: "택시 요금 정책 집중 출제"
4. 저장
→ 이후 모든 택시 시험에 자동 반영
```

### 3. 결과 조회
```
1. http://localhost:5001/results 접속
2. 필터링 (센터, 서비스, 월 등)
3. 상세보기 클릭 → 문제별 정오답 확인
4. 엑셀 다운로드
```

## 🎨 특징

### 1. AI 맞춤형 문제 생성
- Gemini AI가 정책을 학습
- 역할별 난이도 자동 조정
- 관리자 요구사항 반영

### 2. 실시간 타이머
- 1분 전 알림
- 시간 초과 자동 제출
- 부분 답안 채점

### 3. 엑셀 다운로드
- 한글 깨짐 없음
- 문제/답변 전체 포함
- 시간초과 여부 표시

## 🔒 보안

- API 키는 .env 파일에 저장
- .gitignore에 .env 추가 권장
- 프로덕션에서는 환경 변수 사용

## 📄 라이선스

MIT License

## 👥 개발자

KMCC Development Team

## 📞 문의

기술 지원이 필요하시면 연락 주세요.
